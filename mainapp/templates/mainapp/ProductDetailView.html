<!DOCTYPE html>
{% load static %}
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta name="description" content="{{ product.meta_description }}">
	{% include 'mainapp/head-property.html' %}
	<title>{{ product.href_title }} - ПЭК</title>
	<link href="{% static 'css/ProductDetailView.css' %}" rel="stylesheet">

	<link href="{% static 'css/jquery.fancybox.css' %}" rel="stylesheet">

</head>
<body>
	{% include 'mainapp/header.html' %}

<main>
	<div class="d-flex flex-wrap justify-content-center mt-5 " style="
	background-color: #fff;
	position: relative;
	z-index: 2;">
	{% for p in photos %}
	<a data-fancybox='images' href="{{p.image.url}}" data-width="1200">
		<img  src="{{p.image.url}}" class="image">
	</a>
	{% endfor %}
</div>

<div class="top-block">
	<h1 class="text-center"> {{ product.name }}</h1>
</div>



	<div class="row p-0 m-0 mt-5">

		<div class="col-lg-3 d-none d-lg-flex justify-content-center">
			{% include 'mainapp//minor/sidebar.html' %}
		</div>

		<div class="col-12 col-lg-9 col-xxl-6 col-xxl-pre-index col-xxl-6-index p-0">

			<section class="col p-0">
				<div class="container">




				<div class="mod_table_bg py-5">
					<div class="d-flex pl-4 pl-md-0">
						<div class="d-flex flex-column"  id="cart_btn">

							{% for mod in mod_list %}

							<div class="cart-button-wrapper">
								<input class="js-cart-buttons btn" type="button" add-to-cart-url='{% url "product" pk=mod.id %}' >
							</div>

							{% endfor %}
						</div>

						<div class="flex-column mod-table">
								{{ product.mod_table | safe }}

						</div>

					</div>
				</div>

				<div class="content px-3 mt-5">
					{{ product.content | safe }}
				</div>

				<div class="d-flex flex-wrap mb-5 justify-content-center">
				  {% for doc in docs %}
					  <div class="doc-wrap m-2 m-md-3 pb-3 p-2">
							<a href="{{doc.item.file.url}}">
					      <div class="d-flex justify-content-center my-3">
										<svg width="1.5em" height="1.5em" viewBox="0 0 16 16" class="bi bi-file-text" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
									  <path fill-rule="evenodd" d="M4 1h8a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2zm0 1a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1H4z"/>
									  <path fill-rule="evenodd" d="M4.5 10.5A.5.5 0 0 1 5 10h3a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5zm0-2A.5.5 0 0 1 5 8h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5zm0-2A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5zm0-2A.5.5 0 0 1 5 4h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5z"/>
									</svg>
							</div>
							<p>{{doc.name}}</p>
						</a>
					  </div>
				  {% endfor %}
				</div>
			</div>
			</section>
		</div>
	</div>

	<div class="clear" style="clear: both;"></div> <!-- NOTE: необходимо для /minor/sidebar.html -->
</main>
{% include 'mainapp/footer.html' %}

<!-- WARNING:  -->
<script>
var n = 0;
let arr = [];
let arr_slug = [];
{% for mod in mod_list %}
arr[n] = "{{mod.title}}";
arr_slug[n] = "{{ mod.slug_mod }}";
n++;
{% endfor %}

var k = 2; //номер строки в таблице
for (let j = 0; j < arr.length; j++) {
	$("#MOD tr:nth-child(" + k + ") td:nth-child(1)").text(arr[j]);
	$("#MOD tr:nth-child(" + k + ") td:nth-child(1)").wrap("<a href=" + arr_slug[j] + "></a>");
	k++;
}
</script>
<script>

function ArrangementCartIcons() {
		let first_row_height = $('#MOD > tbody > tr:nth-child(1)').outerHeight();
		let second_row_height = $('#MOD > tbody > tr:nth-child(2)').outerHeight();
		{% for mod in mod_list %}
		var row_height = $('#MOD > tbody > tr:nth-child('+ ({{ forloop.counter }} + 1) +')').outerHeight();
		$('.cart-button-wrapper:nth-of-type('+ {{ forloop.counter }} +') .btn').attr('id', 'btn_'+ {{forloop.counter}});
		document.querySelector('#btn_'+ {{forloop.counter }} +'').style['height'] = row_height + 'px';
		{% endfor %}
		document.querySelector('#cart_btn').style['margin-top'] = first_row_height + 1 + 'px';
		document.querySelector('#cart_btn').style['opacity'] = 1;
	}

	$(function(){
		ArrangementCartIcons();//calling function on window load
		$(window).resize(function(){
			ArrangementCartIcons();//calling function on window resize
		});
	});

</script>
<script type="text/javascript">
$(".js-cart-buttons").click(function () {
var id  = "#"+ $(this).attr('id');
console.log(id);
$(id).addClass("btn-animate-hover");
$(id).parent().addClass("btn-animate");
});
</script>


 <!-- not used
<script>
let mod_bg = document.getElementById("MOD").getBoundingClientRect();
let sidebar = document.getElementById('content-left');
let sidebar_now_position = sidebar.getBoundingClientRect();
var position  = mod_bg - sidebar_now_position;
console.log(mod_bg);
console.log(sidebar_now_position);
sidebar.style.marginTop = position + 'px';
</script> -->
<script type="module"  src="{% static 'js/ajax/Product.add-to-cart.js' %}"></script>
<script src="{% static 'js/jquery.fancybox.min.js' %}"></script>
</body>
</html>
